#LyX 2.1 created this file. For more info see http://www.lyx.org/
\lyxformat 474
\begin_document
\begin_header
\textclass amsart
\use_default_options true
\begin_modules
theorems-ams
eqs-within-sections
figs-within-sections
\end_modules
\maintain_unincluded_children false
\language english
\language_package default
\inputencoding auto
\fontencoding global
\font_roman default
\font_sans default
\font_typewriter default
\font_math auto
\font_default_family default
\use_non_tex_fonts false
\font_sc false
\font_osf false
\font_sf_scale 100
\font_tt_scale 100
\graphics default
\default_output_format default
\output_sync 0
\bibtex_command default
\index_command default
\paperfontsize default
\spacing single
\use_hyperref false
\papersize default
\use_geometry false
\use_package amsmath 1
\use_package amssymb 1
\use_package cancel 1
\use_package esint 1
\use_package mathdots 0
\use_package mathtools 1
\use_package mhchem 1
\use_package stackrel 1
\use_package stmaryrd 1
\use_package undertilde 1
\cite_engine basic
\cite_engine_type default
\biblio_style plain
\use_bibtopic false
\use_indices false
\paperorientation portrait
\suppress_date false
\justification true
\use_refstyle 0
\index Index
\shortcut idx
\color #008000
\end_index
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\paragraph_indentation default
\quotes_language english
\papercolumns 1
\papersides 1
\paperpagestyle default
\tracking_changes false
\output_changes false
\html_math_output 0
\html_css_as_file 0
\html_be_strict false
\end_header

\begin_body

\begin_layout Title
Deferred Acceptance
\end_layout

\begin_layout Standard
The point of this note is to take you through the calculations involved
 when using the deferred acceptance algorithm.
 Please read the papers associated with the links on the web page for motivation
 and applications.
\end_layout

\begin_layout Standard
We'll use the example of college placement since you might soon be involved
 in that, and try to work up to something realistic.
 To begin we'll just start with three postgraduate programs or schools,
 call them UBC, SFU, and UoT.
 When we want to refer to the set of schools we can just write 
\begin_inset Formula $Schools.$
\end_inset

 We'll also suppose that there are exactly three students.
 Lets just call them student 1, 2 and 3 eventually we will have a lot of
 them, and it won't make sense anymore to give them names.
 We'll just write 
\begin_inset Formula $Students$
\end_inset

 to refer to the set of students.
\end_layout

\begin_layout Standard
In this introductory example, lets just suppose that each school can only
 admit one student.
 Of course, each of the students can only go to one school, so we want to
 place the students in some reasonable way.
 What we mean by reasonable has to be made precise.
 To do this we need to know the schools and students preferences.
 Lets write the schools' preferences in the following way
\begin_inset Formula 
\[
SFU\rightarrow1\succ2\succ3
\]

\end_inset


\begin_inset Formula 
\[
UBC\rightarrow1\succ3\succ2
\]

\end_inset


\begin_inset Formula 
\[
UOT\rightarrow2\succ3\succ1
\]

\end_inset

What these bits of notation mean is that SFU wants student 1 the most.
 If student 1 doesn't come to SFU then they prefer to have student 2, while
 student 3 is their least favorite student.
 UBC also really wants student 1, but has a different ranking of students
 2 and 3.
 Finally UOT really wants student 2, but if they can't get her, they prefer
 student 3 to student 1.
\end_layout

\begin_layout Standard
We can do the same thing for the students
\begin_inset Formula 
\[
1\rightarrow UBC\succ SFU\succ UOT
\]

\end_inset


\begin_inset Formula 
\[
2\rightarrow UBC\succ UOT\succ SFU
\]

\end_inset


\begin_inset Formula 
\[
3\rightarrow UBC\succ SFU\succ UOT
\]

\end_inset

(the marketing person told me I had to write the preferences that way).
 All three students really want to get into UBC.
 Otherwise, students 1 and 3 want SFU if they are unable to get into UBC.
 Student 2 prefers UOT if she can't get into UBC.
\end_layout

\begin_layout Standard
Now we want to 'place' the students in schools, which means that we want
 to define a 
\emph on
match 
\begin_inset Formula $m:Students\rightarrow Schools$
\end_inset

.
 
\emph default
Then we would write 
\begin_inset Formula $m\left(1\right)=UBC$
\end_inset

 to indicate that student 1 is to be placed in UBC.
 So far, a match needs to be one to one and onto.
\end_layout

\begin_layout Standard
A little visual aid might help you think about the matching.
 Lets start by drawing a table that looks like a normal form game (but isn't).
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SFU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UBC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
The first element of each cell is the 
\emph on
rank 
\emph default
that the university in the corresponding row assigns to the student in the
 corresponding column.
 As above, if you look across the SFU row at the top, student 1 is most
 preferred by UBC, so it has rank 1.
 Similarly, student 2 has rank 2, etc.
 
\end_layout

\begin_layout Standard
As you read down the column, you can read how each of the students ranks
 the various universities by looking at the second element in each cell.
 Reading down column 1, UBC has rank 1, SFU rank 2 and UOT has rank 3.
 This represents the preferences in a compact way.
 
\end_layout

\begin_layout Standard
We can represent a matching by placing three stars in the table in such
 a way that each row has exactly 1 start in it, and each column has exactly
 one star in it.
 For example, here is a matching that puts student 1 in SFU, student 2 in
 UBC and student 3 in UOT:
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SFU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UBC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3*
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
With this simple device, we can start to think about how the students and
 schools 
\emph on
should
\emph default
 be matched.
 All of the students want to be in UBC, which isn't possible since each
 school can only accept one student.
 One obvious criteria that a good match should satisfy is that it be 
\emph on
pareto optimal.
 
\emph default
A match would be pareto dominated if there were some other match that made
 at least one school or student strictly better off without hurting anyone
 else.
 
\end_layout

\begin_layout Standard
Under this criteria, the matching 
\begin_inset Formula $m\left(3\right)=UBC$
\end_inset

, 
\begin_inset Formula $m\left(2\right)=SFU$
\end_inset

, and 
\begin_inset Formula $m\left(1\right)=UOT$
\end_inset

 would be something we would definitely call a bad matching.
 It looks like this:
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SFU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UBC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,1*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Lets see how to improve on it by trying to make some of the schools and
 students better off without hurting the others.
 Student 3 has her favorite program, so if we make any change that moves
 her, she will be worse off.
 So lets focus on students 1 and 2 who both get their least favorite school.
 If we switch them around, they would both be made strictly better off.
 All we need to check is that the schools aren't hurt by this change.
 Since UOT prefers student 2 to student 1, 
\begin_inset Formula $UOT$
\end_inset

 would be made better off.
 Similarly, since 
\begin_inset Formula $SFU$
\end_inset

 prefers student 1 to student 2, SFU is also made better off.
\end_layout

\begin_layout Standard
This new matching 
\begin_inset Formula $m\left(3\right)=UBC$
\end_inset

, 
\begin_inset Formula $m\left(1\right)=SFU$
\end_inset

, and 
\begin_inset Formula $m\left(2\right)=UOT$
\end_inset

 is pareto optimal (if we try to move student 1 to UBC we'll hurt player
 3).
 However, this points out that there is still a problem with this new matching
 because UBC would strictly prefer student 1 to student 3, and student 1
 strictly prefers UBC to SFU where they are now matched.
 If we somehow come up with a game or a mechanism or a market that generates
 the matching 
\begin_inset Formula $m\left(3\right)=UBC$
\end_inset

, 
\begin_inset Formula $m\left(1\right)=SFU$
\end_inset

, and 
\begin_inset Formula $m\left(2\right)=UOT$
\end_inset

, then UBC will want to negotiate a side deal with student 1.
 We would then say that our mechanism is not 
\emph on
stable 
\emph default
so our market would 
\emph on
unravel.
\end_layout

\begin_layout Standard
Formally, a match 
\begin_inset Formula $m$
\end_inset

 is said to be 
\emph on
stable 
\emph default
if for any student 
\begin_inset Formula $i$
\end_inset

 and university 
\begin_inset Formula $j$
\end_inset

, if student 
\begin_inset Formula $i$
\end_inset

 prefers university 
\begin_inset Formula $j$
\end_inset

 to university 
\begin_inset Formula $m\left(i\right)$
\end_inset

, then university 
\begin_inset Formula $m\left(i\right)$
\end_inset

 prefers the student who it gets in 
\begin_inset Formula $m$
\end_inset

 (that would be 
\begin_inset Formula $m^{-1}\left(j\right)$
\end_inset

) to student 
\begin_inset Formula $i$
\end_inset

.
 If that is true, then any attempt to unravel the matching process by some
 kind of offer outside the match will be rejected.
\end_layout

\begin_layout Standard
It is pretty tedious checking all this stuff as you can see.
 Especially if there were thousands of students and many different schools
 involved.
 You might wonder whether we could find an easier way to find a matching
 that is not just pareto optimal, but also stable.
 This is where the deferred acceptance idea comes into play.
 
\end_layout

\begin_layout Subsection*
Algorithms
\end_layout

\begin_layout Standard
An algorithm is a method of systematically checking data to find something
 we are looking for.
 You have seen one algorithm so far - we talked about checking normal form
 games to find all the Nash equilibria.
 That algorithm was really a very poor one - for example, to check for pure
 strategy equilibria we need to check every cell in the payoff matrix to
 see if there were profitable deviations.
 
\end_layout

\begin_layout Standard
Now instead of looking for a Nash equilibrium, we are looking for a stable
 matching.
 This is pretty complicated because we seem to have to check lots of pairings
 to check for stability.
 Fortunately there is a faster way to do this.
 
\end_layout

\begin_layout Standard
This is how the story goes - first we ask each of the students to 
\emph on
propose 
\emph default
to their favorite university.
 This doesn't seem to help much because they all like UBC.
 Nonetheless, lets suppose each of them makes such a proposal.
 UBC now responds by picking its favorite applicant - student 1 in our example.
 UBC 
\emph on
tentatively 
\emph default
accepts student 1's proposal.
 The reason for the word 'tentative' won't be clear in this example, but
 the idea we have in mind is that UBC might later get a better proposal
 and we want to allow UBC to accept this proposal if it ever comes along.
 
\end_layout

\begin_layout Standard
We could visualize these proposals in the following simple way:
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SFU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UBC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,1*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
This isn't a feasible matching because UBC's row has three stars in it,
 and it is only allowed 1.
 To indicate that UBC has rejected the proposals by 2 and 3 we could write
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SFU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UBC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
3,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
2,1*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
At this stage UBC has tentatively accepted student 1's proposal, students
 2 and 3 are still left without places.
 We have actually learned quite a bit from this.
 Students 2 and 3 know that UBC has just tentatively accepted player 1's
 proposal.
 Yet they also know that if UBC ever throws that proposal out in future,
 it will be for a student that it strictly prefers to student 1.
 Then by transitivity, this student will be preferred to students 2 and
 3, in other words, there is no point in students 2 and 3 bothering to propose
 to UBC again.
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="4" columns="4">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SFU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,2*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UBC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
3,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
2,1*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
So in stage 2, we want students 2 and 3 to make proposals to schools who
 have not yet rejected them - 2 will propose to UOT, 3 will propose to SFU.
 Since the universities have only one proposal, they accept that proposal,
 and we are finished.
 This stable matching is 
\begin_inset Formula $m\left(1\right)=UBC$
\end_inset

, 
\begin_inset Formula $m\left(2\right)=UOT$
\end_inset

, 
\begin_inset Formula $m\left(3\right)=SFU$
\end_inset

 
\end_layout

\begin_layout Standard
Unlike our previous effort, this matching won't unravel.
 SFU does badly in a way, since they get their least preferred applicant.
 Yet if SFU approaches student 1 or 2 who they prefer, they will be rejected,
 because each of them is already matched to a university that they prefer
 to SFU.
\end_layout

\begin_layout Standard
This, in a very simple form, is how the deferred acceptance 
\emph on
algorithm 
\emph default
works.
\end_layout

\begin_layout Subsection
Implementing the Deferred Acceptance Solution
\end_layout

\begin_layout Standard
Now we are starting to get somewhere.
 We have something that looks like data, and a process for turning the data
 into an outcome that we like.
 The last step is to turn this process and algorithm into something that
 works in practice.
 To do this, we need to find some way to convince market participants to
 voluntarily give us the data we want about preferences.
 
\end_layout

\begin_layout Standard
One way we could do it is to have the students physically apply to each
 of the schools just as we suggested above.
 Many matching 'markets' work like this.
 In fact, the process of applying to firms who then choose which applicants
 to hire is the way job markets would be described in most economics application
s.
 
\end_layout

\begin_layout Standard
The market with which I am most familiar is the market for junior academic
 economists.
 The applicants are economics students graduating with Ph'd degrees.
 The firms are Universities, Governments, and Consulting firms throughout
 the world.
 The market runs through much of the year, but the primary hiring period
 begins in October when Universities place job ads.
 In 2014 there were a little more than 4000 applicants registered at econjobmark
et.org, one of the main advertising and recruiting sites.
 The number of academic openings is somewhere between 1200 and 1600.
 Junior economists apply to schools they are interested in.
 The schools review applications, interview applicants at a centralized
 meeting in January, then make offers to the applicants they like.
 The applicants, many of whom receive multiple offers, choose the offer
 that they like.
\end_layout

\begin_layout Standard
This might give you some idea about the potential size of a market, and
 how complex it might be to find some kind of stable matching.
 It mostly illustrates that it won't be feasible to find a good solution
 by scribbling on pieces of paper, as we did above.
 The market for junior economists has some complexities that we'll discuss
 later.
 
\end_layout

\begin_layout Standard
In 2013, the Vancouver School Board implemented a matching program for children
 in special kindergarten programs.
 There were four programs, French Immersion, Mandarin Immersion, Montessori,
 and Fine Arts, spread over 19 schools.
 In the year prior to their program, about 1400 students participated.
 The school board discussed the possibility of matching students using deferred
 acceptance, but later changed their mind and used a simple computerized
 lottery using only parents' first choice.
 This system replaced one in which parents physically traveled to as many
 schools as they wanted and submitted an application.
 Schools then ran their own lotteries.
\end_layout

\begin_layout Standard
Neither of these examples actually use the deferred acceptance algorithm
 that we will discuss below.
 In the school board case, the board was concerned about the difficulty
 parents might have expressing their preferences over schools.
 In the the academic job market, universities don't have clear preferences
 at the start of the process and need time to develop them.
 There is no hope of implementing a pareto optimal and stable matching if
 you don't know participants preferences.
 The Vancouver school board example is an interesting case in point.
 The way their current matching program works is that each parent lists
 three schools in order or their preference.
 The actual lottery only makes use of the first choice.
 Each child is entered into a draw for their parents first choice program.
 If they win the draw, that is great.
 If they don't, they are put on a waiting list for that school in case another
 family who did win the lottery decides to decline.
 Since parents who listed a school as their first choice are always put
 on a waiting list, the second and third choice are basically not attainable.
 If parents are very anxious to get their children into a special program,
 they need to choose the program where they think they are most likely to
 get in.
 This may or may not be the one they most prefer for their child.
\end_layout

\begin_layout Standard
This is one of the reasons that deferred acceptance is advantageous.
 The side who make proposals (parents in the case of the Vancouver School
 Board, students in the college application example) have no reason to mis-repre
sent their preferences the way they do with the Vancouver School Board example.
 One of the things that is important in market design is which side should
 make proposals.
\end_layout

\begin_layout Standard
We could alter our procedure above and have the schools make proposals.
 First, UBC and SFU could both send proposals, or acceptance offers to student
 1 whom they most prefer.
 UOT sends an acceptance letter to student 2 since they like her best.
 Student 1 tentatively accepts the offer by UBC and rejects SFU, while student
 2 accepts the offer from UOT.
 SFU sends an offer to student 2, but student 2 rejects it because he likes
 UOT better, finally SFU makes the offer to student 3, who accepts it and
 we are done.
 Same matching as when students propose.
\end_layout

\begin_layout Standard
As long as student 1 can hold onto his offer until he learns whether or
 not he will get a better one, this procedure works pretty well.
 One of the things that can make this procedure fail is something called
 an 'exploding' offer.
 UBC might send an acceptance to student 1, but require that student 1 accept
 it almost immediately - in particular, before student 1 learns whether
 he might get offers from other schools.
 This doesn't make any difference here since student 1 won't get any better
 offers anyway.
 Yet this is generally a major problem for matching markets.
\end_layout

\begin_layout Standard
This brings us to modern mechanism design since computers give us a way
 to do all this almost instantaneously.
 Suppose we organize this market the following way - each student simply
 goes to a web page and writes down her preferences exactly as we did at
 the top of this note.
 In other words, student 1 simply looks at a list consisting of the items
 UBC,SFU and UOT and shifts the elements of the list up and down until her
 favorite school is at the top, second favorite in the middle, etc.
 She clicks on submit, and a computer now knows her preferences in the same
 way we did when we discussed this above.
 The other students and the universities do exactly the same thing.
 Now the computer simply goes through the steps we describe above, and finds
 the matching 
\begin_inset Formula $m\left(1\right)=UBC$
\end_inset

, 
\begin_inset Formula $m\left(2\right)=UOT$
\end_inset

, 
\begin_inset Formula $m\left(3\right)=SFU$
\end_inset

 using either the student proposing or school proposing deferred acceptance
 method.
\end_layout

\begin_layout Standard
Now we are at the point we wanted since the students and schools are basically
 involved in a simple game.
 The actions available to the students are the various preferences they
 could provide on the web page, i.e 
\begin_inset Formula $UBC\succ SFU\succ UOT$
\end_inset

, 
\begin_inset Formula $UBC\succ UOT\succ SFU$
\end_inset

, etc (there are 
\begin_inset Formula $3!$
\end_inset

 or 6 of them in all).
 Given the strategies of the other students and schools, each such preference
 results in a matching.
 For example, if the others are expected to announce their preference as
 we described them above, we could calculate what student 1 could achieve
 for each possible preference she might express.
 It looks like this
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="2">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $UBC\succ SFU\succ UOT$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $UBC$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $UBC\succ UOT\succ SFU$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $UBC$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $SFU\succ UBC\succ UOT$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $SFU$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $SFU\succ UOT\succ UBC$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $SFU$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $UOT\succ SFU\succ UBC$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $SFU$
\end_inset


\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $UOT\succ UBC\succ SFU$
\end_inset


\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
\begin_inset Formula $SFU$
\end_inset


\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
Lets go through the second to last line to see how the table works.
 The first entry is 
\begin_inset Formula $UOT\succ SFU\succ UBC$
\end_inset

 which means that student 1 submits the preference 
\begin_inset Formula $UOT\succ SFU\succ UBC$
\end_inset

 to the computer that will then use the student proposing version of the
 algorithm to find a matching.
 If player 1 submits this preference, then the computer will submit applications
 to UBC for students 2 and 3 and submit an application to UOT for student
 1.
 At that point, the computer can see that UBC prefers student 3 to student
 2, while UOT has only an application from student 1, so the computer will
 reject student 2 from UBC and go on to the next round.
 
\end_layout

\begin_layout Standard
In the second round, the computer thinks that student 2 prefers UOT to SFU,
 so it will submit an application to UOT for student 2, and use this to
 reject the application by student 1.
 At that point students 2 and three have been matched, so in the final round,
 the computer just submits an application to SFU for student 1.
 This is what the rightmost column says - it gives the school that student
 1 will be matched to if he submits that preference to the computer.
 Since student 1 prefers UBC to SFU, it isn't in his interest to submit
 such a preference.
 It is a best reply for student 1 to submit his true preference to the computer
 if he expects the others to submit preferences as we described at the beginning
 of this note.
\end_layout

\begin_layout Standard
It isn't always in everyone's interest to submit their preferences truthfully.
 For example, suppose we look at a simpler problem with only SFU and UBC
 and only two students, 1 and 2.
 We'll add the option of not going to university and suppose that preferences
 look like this
\begin_inset Formula 
\[
UBC\rightarrow1\succ2
\]

\end_inset


\begin_inset Formula 
\[
SFU\rightarrow2\succ1
\]

\end_inset

while the students' preferences are
\begin_inset Formula 
\[
1\rightarrow SFU\succ UBC\succ OUT
\]

\end_inset

and
\begin_inset Formula 
\[
2\rightarrow UBC\succ SFU\succ OUT
\]

\end_inset


\end_layout

\begin_layout Standard
The student proposing algorithm has 1 applying to SFU and 2 applying to
 UBC.
 That is it, there are no more proposals.
 So 
\begin_inset Formula $m\left(1\right)=SFU,$
\end_inset

 
\begin_inset Formula $m\left(2\right)=UBC$
\end_inset

.
 The school proposing algorithm has UBC proposing to 1 and SFU proposing
 to 2, so the matching is 
\begin_inset Formula $m\left(1\right)=UBC$
\end_inset

, 
\begin_inset Formula $m\left(2\right)=SFU$
\end_inset

.
 Notice that both the schools are better off in the school proposing algorithm
 than they are in the student proposing algorithm.
\end_layout

\begin_layout Standard
Now notice that something strange happens in this example.
 Suppose that in the school proposing version, that student 1 simply lies
 and says that if he can't get into school, he would rather not to go school
 at all.
 In other words, he or she submits the preference 
\begin_inset Formula $1\rightarrow SFU\succ OUT\succ UBC$
\end_inset

.
 Lets run the school proposing version of the algorithm - UBC proposes to
 1 and SFU proposes to 2.
 At this point, our computerized algorithm decides that 1 should reject
 UBC's proposal because it thinks he would rather not go to school at all.
 Since its offer has been rejected, UBC now proposes to its second favorite
 choice, student 1, who drops the SFU offer and goes to UBC.
 SFU now has to make an offer to student 1, who accept it.
 By lying student 1 makes himself strictly better off, but only in the school
 proposing version of the algorithm.
 
\end_layout

\begin_layout Standard
Here are the two remarkable facts about this computerized procedure:
\end_layout

\begin_layout Enumerate
The student proposing version of the deferred acceptance algorithm (which
 we just described) will always lead (in a finite number of steps) to a
 matching that is stable given the submitted preferences: and
\end_layout

\begin_layout Enumerate
It is always in the interests of the students to submit their preferences
 truthfully no matter what preferences they think the others are going to
 submit.
\end_layout

\begin_layout Standard
It is hard to emphasize how useful these observations are.
 First, the process of sending letters and acceptances and agonizingly waiting
 to hear if a better offer will come is accomplished in the blink of an
 eye by the computer.
 Speed is not the only issue, all the time spent handing the communication
 is also eliminated.
 
\end_layout

\begin_layout Standard
Second, students send their preferences to the computer which can record
 them for future use.
 Students never want to lie about their preferences, this isn't a happiness
 survey, it is in the interests of the students to reveal they way they
 would make choices on their own.
 Now instead of relying on universities web pages, which almost always make
 the claim that they are one of the top universities in the world, you can
 just look at the preferences that students submitted and see for yourself.
 Recall that even if you find that one university is very popular, there
 is no reason for you to pretend that you like some less popular university
 in the hopes that you will get in there once you are refused at the popular
 university.
 The computer already takes care of that.
\end_layout

\begin_layout Standard
Just so you can see the kind or reasoning used in the literature on this
 topic, we can go through a proof of the first of these two facts.
 As always, you should be a skeptic.
 Just because the algorithm produces a stable matching with the examples
 that I used above doesn't mean it always will.
 Anyway, why exactly does the algorithm work in the the examples above.
 When you think of it, it is pretty hard to check.
 To do so, one really should take every pair of universities and students
 and ask whether the student chosen would prefer to be in this alternative
 university instead of being in the match produced by the algorithm, while
 at the same time the university would prefer to admit the student (possibly
 after kicking out someone else) to the group with whom they are matched
 during the algorithm.
\end_layout

\begin_layout Standard
We need a bit of formality to do this.
 Suppose there are 
\begin_inset Formula $n$
\end_inset

 students each indicated by an index 
\begin_inset Formula $j$
\end_inset

.
 So 
\begin_inset Formula $j\in n$
\end_inset

 just means that 
\begin_inset Formula $j$
\end_inset

 is the name of a student.
 At the same time, suppose that there are 
\begin_inset Formula $m$
\end_inset

 universities (probably 
\begin_inset Formula $m$
\end_inset

 is much smaller than 
\begin_inset Formula $n$
\end_inset

).
 The notation 
\begin_inset Formula $i\in m$
\end_inset

 just means that 
\begin_inset Formula $i$
\end_inset

 is the name of a university.
 This convention is adopted in what follows, 
\begin_inset Formula $i$
\end_inset

, and its variants like 
\begin_inset Formula $i^{\prime}$
\end_inset

 always refer to a university, 
\begin_inset Formula $j$
\end_inset

 to a student.
 Lets refer to a matching by the Greek letter 
\begin_inset Formula $\mu$
\end_inset

.
 Then if we put the name of a student into 
\begin_inset Formula $\mu$
\end_inset

, the result will be the name of the university that the student has been
 placed in.
 For example, in the example we started with at the beginning of this note,
 
\begin_inset Formula $\mu\left(3\right)=UBC$
\end_inset

.
 If we put the name of a university in the matching function, for example,
 
\begin_inset Formula $\mu\left(i\right)$
\end_inset

, we get a list of all the students who were placed in the university by
 our matching procedure.
 When we need it, we'll let 
\begin_inset Formula $k_{i}$
\end_inset

 be the capacity of university 
\begin_inset Formula $i$
\end_inset

, i.e., the maximum number of students that 
\begin_inset Formula $i$
\end_inset

 can admit.
\end_layout

\begin_layout Standard
Second, we need an assumption about university preferences.
 Let 
\begin_inset Formula $S$
\end_inset

 be any collection of students who have been admitted to some university
 
\begin_inset Formula $i$
\end_inset

, and that 
\begin_inset Formula $i$
\end_inset

 has space for some more students.
 Let 
\begin_inset Formula $j$
\end_inset

 and 
\begin_inset Formula $j^{\prime}$
\end_inset

 be two students who the university has not yet admitted.
\end_layout

\begin_layout Definition
University 
\begin_inset Formula $i$
\end_inset

 has responsive preferences if 
\begin_inset Formula $S\cup\left\{ j\right\} \succ_{i}S\cup\left\{ j^{\prime}\right\} \implies\forall S^{\prime};S^{\prime}\cup\left\{ j\right\} \succ_{i}S^{\prime}\cup\left\{ j^{\prime}\right\} $
\end_inset

.
\end_layout

\begin_layout Definition
What this definition says is that whether or not a university likes one
 student more than another doesn't depend on the set of students the university
 has already admitted (or on the set it expects to admit).
 An example is a university that ranks students according to their GPA or
 SAT scores.
\end_layout

\begin_layout Theorem
If universities have responsive preferences, and students and universities
 provide their true preferences, then the deferred acceptance algorithm
 will always produce a stable matching.
\end_layout

\begin_layout Proof
The matching is supposed to be stable in this theorem, so suppose the 
\begin_inset Formula $\mu^{\prime}$
\end_inset

 is a matching produced by the deferred acceptance algorithm which isn't
 stable.
 We'll just prove that if the matching isn't stable, then it couldn't have
 been produced by deferred acceptance.
\end_layout

\begin_layout Proof
First, what does it mean to say that the matching isn't stable.
 If that is true, then there is a student, say 
\begin_inset Formula $j$
\end_inset

 and a university, say 
\begin_inset Formula $i$
\end_inset

, such that 
\begin_inset Formula $j$
\end_inset

 would strictly prefer to be in university 
\begin_inset Formula $i$
\end_inset

 that in university 
\begin_inset Formula $\mu^{\prime}\left(j\right)$
\end_inset

 where they were placed by deferred acceptance, while at the same time,
 university 
\begin_inset Formula $i$
\end_inset

 would either like to add student 
\begin_inset Formula $j$
\end_inset

 to the set of students it has already accepted (if it has space), or would
 like to replace one of its existing students with student 
\begin_inset Formula $j$
\end_inset

 (if it is full).
\end_layout

\begin_layout Proof
Now the rules of the deferred acceptance algorithm are very strict - at
 each step the student must send an application to the university he or
 she most prefers among the group of universities that have not yet rejected
 one of their applications.
 Since 
\begin_inset Formula $j$
\end_inset

 must have sent an application to 
\begin_inset Formula $\mu^{\prime}\left(j\right)$
\end_inset

, but prefers 
\begin_inset Formula $i$
\end_inset

 to 
\begin_inset Formula $\mu^{\prime}\left(j\right)$
\end_inset

, it must have been the case that 
\begin_inset Formula $j$
\end_inset

 sent an application to 
\begin_inset Formula $i$
\end_inset

 which was rejected.
 That is just the way the algorithm works, if 
\begin_inset Formula $j$
\end_inset

 hadn't received a rejection from 
\begin_inset Formula $i$
\end_inset

, the program would not have sent an application to 
\begin_inset Formula $\mu^{\prime}\left(j\right)$
\end_inset

 and would have sent it to 
\begin_inset Formula $i$
\end_inset

 instead.
\end_layout

\begin_layout Proof
The next question is why 
\begin_inset Formula $i$
\end_inset

 would have rejected 
\begin_inset Formula $j$
\end_inset

's application.
 The only time the program will allow the university to reject an application
 is when it has already received applications from a group of students all
 of whom are preferred to applicant 
\begin_inset Formula $j$
\end_inset

.
\begin_inset Foot
status collapsed

\begin_layout Plain Layout
We don't really need to worry about university 
\begin_inset Formula $i$
\end_inset

 rejecting student 
\begin_inset Formula $j$
\end_inset

 because their GPA isn't high enough - if that were true the university
 would never have wanted to admit 
\begin_inset Formula $j$
\end_inset

 after the matching either.
\end_layout

\end_inset

 So the university liked its existing applicants better when 
\begin_inset Formula $j$
\end_inset

 applied.
 After that, the algorithm would continue to process new applications for
 the university, some students would be admitted, and others dropped, some
 would be rejected.
 No matter how long this process continued after 
\begin_inset Formula $j$
\end_inset

's application, the university would only have admitted new students that
 it preferred to one of their existing acceptances.
 Since we now know that the existing applicant must have been preferred
 to 
\begin_inset Formula $j$
\end_inset

, the new applicants who are admitted must also be preferred to 
\begin_inset Formula $j$
\end_inset

 (by responsive preferences), so it is impossible for the university to
 want to admit 
\begin_inset Formula $j$
\end_inset

 after the matching is finished.
 By this Sherlockian deductive process we can conclude that there cannot
 be a matching produced by the deferred acceptance algorithm that is unstable.
\end_layout

\begin_layout Standard
Notice a few things about this argument.
 First, we need the university to have responsive preferences.
 For example, the Stanford MBA program might prefer a student with an engineerin
g background to a student with an English degree if it expects lots of applicati
ons from good humanities students.
 Yet it might find that near the end of the algorithm that it hasn't received
 the humanities applications it expected.
 Then it might decide to change its mind.
 This would be a violation of responsive preferences, and you can see that
 our argument above would fail in this case (which is why we added the assumptio
n).
\end_layout

\begin_layout Standard
Of course, the second thing to consider here is that the algorithm uses
 the preferences that the university submitted at the very start.
 If these aren't the university's real preferences, then it might well want
 to admit the student once it finds out that its attempt to manipulate the
 outcome hasn't worked the way it wanted.
\end_layout

\begin_layout Standard
I'll stick with the student proposing version of the algorithm in what follows,
 and just note it isn't always in the interests of the universities to submit
 their preferences truthfully.
 Often this doesn't matter that much.
 Universities have moved away from screening students to graduating as many
 students as they can.
 So typically the constraints from the universities point of view are just
 capacity.
 We'll explicitly come back to deal with this since it is an important considera
tion in a lot of matching problems.
 So lets just try something slightly more complicated.
\end_layout

\begin_layout Subsection
A slightly more complicated problem:
\end_layout

\begin_layout Standard
Lets make things slightly more complicated by adding a few more students,
 another university, and another option, The additional option will be not
 going to university at all.
 Here are the preferences.
 At this point you can imagine that these are preferences that were actually
 submitted through the web page.
 The problem is just to do the matching.
 Here are the preferences written in two different ways:
\begin_inset Formula 
\[
SFU\rightarrow1\succ4\succ2\succ3
\]

\end_inset


\begin_inset Formula 
\[
UBC\rightarrow1\succ3\succ4\succ2
\]

\end_inset


\begin_inset Formula 
\[
UOT\rightarrow2\succ3\succ1\succ4
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
UFV\rightarrow2\succ3\succ4\succ1
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
1\rightarrow UBC\succ SFU\succ UOT\succ UFV\succ OUT
\]

\end_inset


\begin_inset Formula 
\[
2\rightarrow UBC\succ UOT\succ SFU\succ UFV\succ OUT
\]

\end_inset


\begin_inset Formula 
\[
3\rightarrow UBC\succ SFU\succ UOT\succ UFV\succ OUT
\]

\end_inset


\end_layout

\begin_layout Standard
\begin_inset Formula 
\[
4\rightarrow UBC\succ UOT\succ SFU\succ OUT\succ UFV
\]

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UBC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4,1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,1
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SFU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UFV
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4,2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OUT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,4
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
We've added a fourth university (if you like name UFV means University of
 the Fraser Valley).
 There is also a fourth student who only wants to go to UBC, SFU or UOT,
 but is not interested in UFV.
\end_layout

\begin_layout Standard
Lets find a stable matching using the algorithm:
\end_layout

\begin_layout Enumerate
All students propose to UBC, which tentatively accepts student 1 and rejects
 the other proposals;
\end_layout

\begin_layout Enumerate
Students 2 and 4 propose to UOT, while student 3 proposes to SFU, SFU tentativel
y accepts student 3, UOT tentatively accepts student 2 who it prefers;
\end_layout

\begin_layout Enumerate
Student 4, who has been rejected by UBC and UOT, now proposes to his remaining
 favorite SFU.
 SFU prefers 4 to their current acceptance, 3, so they throw 3 out and accept
 4;
\end_layout

\begin_layout Enumerate
Student 3 has been rejected by UBC and now SFU, so he proposed to his next
 favorite, UOT who has currently accepted 2 who they prefer, student 3's
 application is rejected;
\end_layout

\begin_layout Enumerate
Finally, student 3 proposes to UFV who accepts him.
\end_layout

\begin_layout Standard
This gives us
\begin_inset Formula 
\[
m\left(1\right)=UBC,m\left(2\right)=UOT,m\left(3\right)=UFV,m\left(4\right)=SFU.
\]

\end_inset


\end_layout

\begin_layout Standard
Now in pictures:
\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UBC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,1*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SFU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UFV
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4,2
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OUT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,4
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UBC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
4,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
2,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
3,1*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SFU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4,2*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UFV
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4,2*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OUT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,4
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UBC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
4,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
2,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
3,1*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SFU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4,2*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UFV
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
4,2*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OUT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,4
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UBC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
4,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
2,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
3,1*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SFU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
4,2*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UFV
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
4,2*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OUT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,4
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard
\align center
\begin_inset Tabular
<lyxtabular version="3" rows="6" columns="5">
<features rotate="0" tabularvalignment="middle">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
4
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UBC
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
4,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
2,1*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
3,1*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
SFU
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
4,2*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,3*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UFV
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,4
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
2,4*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,5
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
UOT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
3,3
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
1,2*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
2,3*
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout

\color red
4,2*
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
OUT
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,5
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" bottomline="true" leftline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Plain Layout
-,4
\end_layout

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Standard

\series bold
Exercise: 
\end_layout

\begin_layout Enumerate
Find the stable outcome associated with the university proposing deferred
 acceptance algorithm for this last example.
 Are they the same? Can you see why this means that the stable matching
 is unique in this case? Can you see why neither schools or students want
 to misrepresent their preferences in this case?
\end_layout

\begin_layout Enumerate
Suppose all the students agree on the ranking of the schools (pick your
 favorite ranking).
 What happens.
 Is there a difference between the student proposing and the school proposing
 outcome?
\end_layout

\begin_layout Enumerate
As special case of the above occurs when all the schools agree on the ranking
 of students, and all the students agree on a ranking of schools.
 What happens then? This outcome is called 'assortative matching'.
\end_layout

\begin_layout Enumerate
Go back to the problem we discussed above in which students lied about their
 preferences when using the school proposing algorithm.
 Can you describe one or more Nash equilibrium outcomes having the property
 that every students and schools report about their preferences is a best
 reply to the reports of the others? How do schools report in these equilibria?
\end_layout

\begin_layout Subsection*
Indifference
\end_layout

\begin_layout Standard
Lets go back to our original problem in which 3 students rated 3 schools
 according to
\begin_inset Formula 
\[
1\rightarrow UBC\succ UOT\succ SFU
\]

\end_inset


\begin_inset Formula 
\[
2\rightarrow UBC\succ SFU\succ UOT
\]

\end_inset


\begin_inset Formula 
\[
3\rightarrow UOT\succ UBC\succ SFU
\]

\end_inset


\end_layout

\begin_layout Standard
Now when the students submitted these preferences, lets suppose that 1 and
 2 are exactly as stated, but that 2 really doesn't care whether he goes
 to UBC or SFU, but strictly prefers both of them to UOT.
 He had to fill out something as his favorite choice, so he flipped a coin
 and it came out UBC.
 Furthermore, lets change the preferences of the schools so that they don't
 really care who they admit, they just want to fill their slots.
 What should you do then?
\end_layout

\begin_layout Standard
Recall that the student proposing deferred acceptance algorithm supports
 a stable outcome and has the property that students report their preferences
 truthfully.
 To make it work, we needed the schools to reject applications.
 We can make them do that by having them run a lottery which ranks the students.
 So the administrators in the different schools create a spreadsheet with
 the three students listed in one column and then sort the column randomly.
 Once they do this they submit these randomized preferences.
 They could look like anything, but suppose they were
\begin_inset Formula 
\[
SFU\rightarrow3\succ1\succ2
\]

\end_inset


\begin_inset Formula 
\[
UBC\rightarrow2\succ3\succ1
\]

\end_inset


\begin_inset Formula 
\[
UOT\rightarrow1\succ2\succ3.
\]

\end_inset


\end_layout

\begin_layout Standard
Now the program runs, and 2 gets into UBC, 1 gets into UOT and 3 gets into
 SFU.
 This is stable given the stated preferences, but these preferences are
 masking a lot of indifference.
 In fact, if we switched 1 to UBC, 2 to SFU and 3 to UOT, 1 and 3 would
 be strictly better off and 2 would be no worse than he was initially.
 Since the schools don't really care, this new matching would constitute
 a pareto improvement - not good.
\end_layout

\begin_layout Standard
In this simple case, there is an easy way to resolve this.
 It provides an example of something called the 'top cycle' algorithm.
 In the matching above 
\begin_inset Formula $m\left(2\right)=UBC$
\end_inset

, 
\begin_inset Formula $m\left(1\right)=UT$
\end_inset

, 
\begin_inset Formula $m\left(3\right)=SFU$
\end_inset

.
 The students learn this information.
 Suppose we now give them the option to propose one or more schools that
 they would be willing to trade for their existing allocation - encouraging
 them to include another school if they don't really care whether they are
 matched with their existing school or their alternative proposal.
 The proviso is that they must be willing to give up their existing school
 for the alternative they specify.
 The system will switch them to the new school if they can.
\end_layout

\begin_layout Standard
Hopefully, student 2 will propose that he is willing to trade UBC for SFU.
 Student 1 should propose to trade UBC for UT.
 Student 3 should propose trading either UT or UBC for his current allocation
 at SFU.
 The top cycle algorithm takes these proposed trades and goes through the
 following routine:
\end_layout

\begin_layout Enumerate
Choose any student, say student 1 and check whether there are any schools
 he would like to trade for his current match.
 Student 1 has proposed UBC as an alternative to UT.
 So we start looking for a cycle using student 1.
\end_layout

\begin_layout Enumerate
UBC is owned by student 2, so check whether there is any school that student
 2 is willing to trade for UBC.
 We find he has proposed SFU as an alternative he would be willing to trade.
 So lets add student 2 to our cycle, getting 
\begin_inset Formula $1\rightarrow2$
\end_inset

.
\end_layout

\begin_layout Enumerate
SFU is owned by student 3, so check whether there is any school that 3 is
 willing to trade.
 One of the schools he has proposed is UBC, so lets add student 3 to the
 cycle 
\begin_inset Formula $1\rightarrow2\rightarrow3$
\end_inset

.
\end_layout

\begin_layout Enumerate
UBC is owned by student 2 who is willing to trade for UBC, so add him 
\begin_inset Formula $1\rightarrow2\rightarrow3\rightarrow2$
\end_inset

.
\end_layout

\begin_layout Standard
In this last step, we added a student who is already in the list.
 This gives us a 'top cycle'.
 If we continued to apply the steps in the algorithm above we would cycle
 back and forth between student 2 and 3.
 The reason for the cycle is that 2 prefers the school that 3 has and 3
 prefers the school that 2 has.
 So switching them creates a pareto improvement.
 We might as well switch them and change the matching to 
\begin_inset Formula $m\left(2\right)=SFU$
\end_inset

, 
\begin_inset Formula $m\left(1\right)=UT$
\end_inset

, 
\begin_inset Formula $m\left(3\right)=UBC.$
\end_inset


\end_layout

\begin_layout Standard
Notice that we made some students better off, and didn't hurt anyone.
 You only propose trades you prefer - you might get them or you might get
 nothing.
 No one is being made any worse off that they were initially.
 We might as well ask the question again, are there any schools you would
 be willing to trade for your new allocation.
 All three of them have schools they prefer - 1 prefers UBC to his new allocatio
n at UT, 2 also prefers UBC while 3 prefers UT.
 So lets do it again:
\end_layout

\begin_layout Enumerate
1 prefers UBC to UT so lets add him to the cycle 
\begin_inset Formula $1\rightarrow$
\end_inset

;
\end_layout

\begin_layout Enumerate
UBC is now owned by student 3 who prefers UT, so lets add her to the cycle
 
\begin_inset Formula $1\rightarrow3$
\end_inset

;
\end_layout

\begin_layout Enumerate
UT is owned by 
\begin_inset Formula $1$
\end_inset

 who prefers UT so we have 
\begin_inset Formula $1\rightarrow3\rightarrow1$
\end_inset

 - a top cycle.
\end_layout

\begin_layout Standard
So student 1 and 3 should switch schools giving 
\begin_inset Formula $m\left(2\right)=SFU$
\end_inset

, 
\begin_inset Formula $m\left(1\right)=UBC$
\end_inset

, 
\begin_inset Formula $m\left(3\right)=UT$
\end_inset

.
\end_layout

\begin_layout Standard
If we try this again we will find the only student we can add to a cycle
 is student 2 who prefers UBC, but it is owned by student 1 who is no longer
 willing to move - our algorithm comes to an end with an allocation that
 is pareto optimal and stable as long as the students haven't lied about
 their preferences.
 In fact, if you recall, we assumed that student 2 didn't really care whether
 he got UBC or SFU, so each of the students actually gets his favorite choice.
\end_layout

\end_body
\end_document
